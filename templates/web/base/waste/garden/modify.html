[% extra_js = [
    version('/js/waste.js')
] ~%]
[% INCLUDE 'waste/header.html' %]

[% PROCESS 'govuk/fields.html' %]
[% PROCESS title title=form.title %]
[% PROCESS errors %]

<dl class="waste__address">
    <dt class="waste__address__title">Collection address</dt>
    <dd class="waste__address__property">[% property.address %]</dd>
</dl>

<form method="post" id="modify">
  <fieldset class="govuk-fieldset">
    <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
      <h2 class="govuk-fieldset__heading">How many bins do you need us to collect?</h2>
    </legend>

  <!-- [% PROCESS form override_fields=['current_bins'] %] -->
    <hr class="fieldset-hr">
    <div class="fieldset-container">
      <div class="fieldset-item">
        <label class="govuk-label" for="[% field.id %]">
            [% field.label %]
        </label>
      [% IF field.get_tag('hint') %]
        <span id="[% field.id %]-hint" class="govuk-hint">
            [% field.get_tag('hint') %]
        </span>
      [% END %]
      [% IF error %]
        <span id="[% field.id %]-error" class="govuk-error-message">
            <span class="govuk-visually-hidden">Error:</span> [% error %]
        </span>
      [% END %]
      </div>

    <div class="fieldset-item">
      <input class="govuk-input[% IF error %] govuk-input--error[% END %]" id="current_bins" name="current_bins" type="number"
      value="[% field.fif %]"
      [%~ IF field.get_tag('number') %] pattern="[0-9]*" inputmode="numeric"[% END ~%]
      [%~ IF field.get_tag('autofocus') %] autofocus[% END ~%]
      [%~ IF field.disabled %] disabled[% END ~%]
      [%~ IF field.get_tag('hint') OR error %]
        aria-describedby="[% IF field.get_tag('hint') %][% field.id %]-hint [% END %][% IF error %][% field.id %]-error[% END %]"
      [%~ END %]>
    </div>

    <div class="fieldset-item">
    </div>
  </div>

  <!-- [% PROCESS form override_fields=['bins_wanted'] %] -->
    <hr class="fieldset-hr">
    <div class="fieldset-container">
      <div class="fieldset-item">
        <label class="govuk-label" for="[% field.id %]">
            [% field.label %]
        </label>
      [% IF field.get_tag('hint') %]
        <span id="[% field.id %]-hint" class="govuk-hint">
            [% field.get_tag('hint') %]
        </span>
      [% END %]
      [% IF error %]
        <span id="[% field.id %]-error" class="govuk-error-message">
            <span class="govuk-visually-hidden">Error:</span> [% error %]
        </span>
      [% END %]
      </div>

    <div class="fieldset-item">
      <input class="govuk-input[% IF error %] govuk-input--error[% END %]" id="bins_wanted" name="bins_wanted" type="number"
      value="[% field.fif %]"
      [%~ IF field.get_tag('number') %] pattern="[0-9]*" inputmode="numeric"[% END ~%]
      [%~ IF field.get_tag('autofocus') %] autofocus[% END ~%]
      [%~ IF field.disabled %] disabled[% END ~%]
      [%~ IF field.get_tag('hint') OR error %]
        aria-describedby="[% IF field.get_tag('hint') %][% field.id %]-hint [% END %][% IF error %][% field.id %]-error[% END %]"
      [%~ END %]>
    </div>

    <div class="fieldset-item">
      <span class="cost-pa">£[% tprintf('%.2f', per_bin_cost / 100 ) %] per bin per year</span>
    </div>
    
  </div>
  <hr class="fieldset-hr">
  <div class="cost-pa__total">
    <span class="cost-pa__total-costs">
    Total per year, from [% display_end_date.strftime('%e %B %Y') %]: £<span id="cost_per_year">[% tprintf('%.2f', cost_per_year) %]</span>
    </span>
    <span class="cost-pa__total-costs">
        Total to pay now (<span id="new_bin_count">[% new_bin_count %]</span> new <span id="new_bin_text">[% nget( 'bin', 'bins', new_bin_count) %]</span>): £<span id="pro_rata_cost">[% tprintf('%.2f', pro_rata) %]</span>
    </span>
  </div>
  </fieldset>
  
    [% IF staff_payments_allowed %]
    [% PROCESS form override_fields=['name', 'email', 'phone'] %]
    [% ELSE %]
    [% PROCESS form override_fields=['name'] %]
    [% END %]
    [% PROCESS form override_fields=['saved_data', 'token', 'process'] %]
    [% PROCESS form override_fields=['continue_review'] %]

  <input type="hidden" name="per_bin_cost" id="per_bin_cost" value="[% garden_form_data.per_bin_cost %]">
  <input type="hidden" name="pro_rata_bin_cost" id="pro_rata_bin_cost" value="[% garden_form_data.pro_rata_bin_cost %]">
  <input type="hidden" name="existing_bins" id="existing_bins" value="[% garden_form_data.bins %]">

</form>

[% INCLUDE footer.html %]
